
using System.CommandLine;
using System.CommandLine.Invocation;
using IncrementalGeneratorSamples.Runtime;

#nullable enable

namespace MyNamespace;

public partial class WithMultipleProperties
{
    internal class CommandHandler : CommandHandlerBase
    {
        // Manage singleton instance
        public static WithMultipleProperties.CommandHandler Instance { get; } = new WithMultipleProperties.CommandHandler();

        // Create System.CommandLine options
        private Option<string?> propertyOneOption = new Option<string?>("--property-one", "");
        private Option<int> propertyTwoOption = new Option<int>("--property-two", "");
        private Option<System.IO.FileInfo> propertyThreeOption = new Option<System.IO.FileInfo>("--property-three", "");

        // Base constructor creates System.CommandLine and options are added here
        private CommandHandler()
            : base("with-multiple-properties", "")
        {
            
            Command.AddOption(propertyOneOption);
            Command.AddOption(propertyTwoOption);
            Command.AddOption(propertyThreeOption);
        }

        // The code invoked when the user runs the command
        protected override int Invoke(InvocationContext invocationContext)
        {
            var commandResult = invocationContext.ParseResult.CommandResult;
            var command = new WithMultipleProperties(GetValueForSymbol(propertyOneOption, commandResult), GetValueForSymbol(propertyTwoOption, commandResult), GetValueForSymbol(propertyThreeOption, commandResult));
            return command.Execute();
        }
    }
}
